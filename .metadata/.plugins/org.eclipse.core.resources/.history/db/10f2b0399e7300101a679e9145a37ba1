package royanmobiletesting;

import java.net.MalformedURLException;
import java.net.URISyntaxException;
import java.util.List;

import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;
import org.testng.annotations.Test;

import io.appium.java_client.AppiumBy;
import io.appium.java_client.TouchAction;
import io.appium.java_client.touch.offset.PointOption;

public class StepperPress extends BaseTest{
   
	@SuppressWarnings("deprecation")
	@Test
	public void StepperPressed() throws MalformedURLException, URISyntaxException, InterruptedException {
		driver.findElement(AppiumBy.iOSClassChain("**/XCUIElementTypeStaticText[`name == \"Steppers\"`]")).click();
		driver.findElement(AppiumBy.iOSNsPredicateString("name == \"DEFAULT\" AND label == \"DEFAULT\"")).click();
		Thread.sleep(5000);
		driver.findElement(AppiumBy.iOSClassChain("**/XCUIElementTypeStaticText[`name == \"Steppers\"`]")).click();
	    driver.findElement(AppiumBy.iOSNsPredicateString("name == \"DEFAULT\" AND label == \"DEFAULT\"")).click();
	    Thread.sleep(2000);

	    // Get the Decrement buttons
	    List<WebElement> decrementButtons = driver.findElements(AppiumBy.iOSClassChain("**/XCUIElementTypeButton[`name == \"Decrement\"`]"));
	    List<WebElement> incrementButtons = driver.findElements(AppiumBy.iOSClassChain("**/XCUIElementTypeButton[`name == \"Increment\"`]"));

	    System.out.println("Decrement count: " + decrementButtons.size());
	    System.out.println("Increment count: " + incrementButtons.size());

	    TouchAction<?> touchAction = new TouchAction<>(driver);

	    for (int i = 0; i < decrementButtons.size(); i++) {
	        WebElement dec = decrementButtons.get(i);
	        int x = dec.getLocation().getX() + (dec.getSize().getWidth() / 2);
	        int y = dec.getLocation().getY() + (dec.getSize().getHeight() / 2);

	        System.out.println("Tapping Decrement[" + i + "] at (" + x + "," + y + ")");
	        touchAction.tap(PointOption.point(x, y)).perform();

	        Thread.sleep(2000);

	        if (i < incrementButtons.size()) {
	            incrementButtons.get(i).click(); // Normal click works for Increment
	            System.out.println("Clicked Increment[" + i + "]");
	        }

	        Thread.sleep(2000);
	    }
	}
	
}
